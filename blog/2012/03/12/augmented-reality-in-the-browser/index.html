
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Augmented Reality in the Browser - Learning Three.js</title>
  <meta name="author" content="Jerome Etienne">

  
  <meta name="description" content="This post is about augmented reality in the browser.
In a recent post, we saw that it is now possible to
have live video in webgl
with
WebRTC.
Due to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/LearningThreejs" rel="alternate" title="Learning Three.js" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4037844-19']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
	<style>
		#linksPerso {
			float	: right;
			height	: 128px;
		}
		#linksPerso .wrapper {
			height	: 128px;
			overflow-y:hidden;

		}
		#linksPerso img {
			width	: 128px;
		}
	</style>
	<div id='linksPerso' style='display: none;'>
		<div class='wrapper'>
			<div class='linkJSinside'>
			 	<a href='http://jsinside.com' target='_blank'>
					<img src='http://jsinside.com/images/logo/logo-jsinside-512x512.png'/>
				</a>
			</div>
			<div class='linkThreejs'>
				<a href='mailto:jerome.etienne@gmail.com?Subject=Hello%20again' target='_blank'>
					<img src='http://betterjs.org/www/images/logo/logo-betterjs-512x512.png'/>
				</a>
			</div>
			<div class='linkJSinside'>
			 	<a href='http://jsinside.com' target='_blank'>
					<img src='http://jsinside.com/images/logo/logo-jsinside-512x512.png'/>
				</a>
			</div>
		</div>
	</div>
	<script>
	;(function(){
return;
		var counter	= 0
		var element	= jQuery('#linksPerso .wrapper')
		setInterval(function(){
			counter++
			if( Math.floor(counter%2) === 0 ){
				element.animate({
					scrollTop: "256px"
				}, 1000, function(){
					element.scrollTop(0)
				});
			}else{
				element.animate({
					scrollTop: "128px"
				}, 1000);
			}
		}, 1000*4)
	})()
	</script>

  <h1><a href="/">Learning Three.js</a></h1>
  
    <h2>or WebGL for Dummies</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/LearningThreejs" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:learningthreejs.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://jeromeetienne.github.io/videobrowser4learningthreejs/">Videos</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Augmented Reality in the Browser</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-12T11:36:00+01:00" pubdate data-updated="true">Mar 12<span>th</span>, 2012</time>
        
        
          <div class="sharing" style='text-align: right;'>
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/" data-via="LearningThreejs" data-counturl="http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

        
     </p>
    
  </header>


<div class="entry-content"><p>This post is about augmented reality in the browser.
In a recent post, we saw that it is now possible to
<a href="/blog/2012/02/07/live-video-in-webgl/">have live video in webgl</a>
with
<a href="http://www.webrtc.org/">WebRTC</a>.
Due to this,
<a href="http://en.wikipedia.org/wiki/Augmented_reality">augmented reality</a>
is under the spotlight. Recently
<a href="http://www.html5rocks.com/">html5rock</a> published a
tutorial
by
<a href="http://www.html5rocks.com/en/profiles/#ilmari">ilmari heikkinen</a>
about
&#8221;<a href="http://www.html5rocks.com/en/tutorials/webgl/jsartoolkit_webrtc/">writting augmented reality application using jsartoolkit</a>&#8221;.
Ilmari is
<a href="https://plus.google.com/115293744081058969329/about">google devrel for webgl</a>
and the author of
<a href="http://github.com/kig/JSARToolKit">JSARToolKit</a>
too. So we are in good hands :)
The tutorial even include a part about binding it with
<a href="https://github.com/mrdoob/three.js/">three.js</a>.
I took this nice tutorial and packaged the code even easier to reuse.</p>

<!-- more -->




<center>
    <iframe width="425" height="349" src="http://www.youtube.com/embed/rzLuJxTraos" frameborder="0" allowfullscreen></iframe>
</center>


<p><img class="right" src="/data/2012-03-12-augmented-reality-in-the-browser/images/marker-small.png"></p>

<p><a href="http://jeromeetienne.github.com/tquery.jsartoolkit/">Try this demo</a>.
If you got <a href="http://www.webrtc.org/running-the-demos">WebRTC is available</a> in your browser, take
<a href="http://jeromeetienne.github.com/tquery.jsartoolkit/marker/marker.png">this marker</a>,
and put it in front on your webcam.
It is the same you see on the right.
It is best to print it on paper.
If you can&#8217;t, point your phone to
<a href="http://jeromeetienne.github.com/tquery.jsartoolkit/marker">this page</a> instead.
Phone screens tend to reflect lights from your environment tho. They may
reduce the accuracy of the marker detection.</p>

<p>Now let&#8217;s see how you can to use all this to build your own demos :)</p>

<h2>You Include it</h2>

<p>First you include it as usual in your page. The code is available
<a href="https://github.com/jeromeetienne/tquery.jsartoolkit">here</a>.
Note that
<a href="http://github.com/kig/JSARToolKit">JSARToolKit</a>
is released under GPL, so some restrictions apply.
The threex is under MIT license as usual.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;JSARToolKit.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;threex.jsartoolkit.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>You Initialize It</h2>

<p>Once you get the code, you instanciate the object like this.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">threexAR</span>   <span class="o">=</span> <span class="k">new</span> <span class="nx">THREEx</span><span class="p">.</span><span class="nx">JSARToolKit</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">srcElement</span>  <span class="o">:</span> <span class="nx">srcElement</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">threshold</span>   <span class="o">:</span> <span class="nx">threshold</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">callback</span>    <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>srcElement</code> may be a
<a href="http://en.wikipedia.org/wiki/HTML5_video">video</a>, an
<a href="http://www.w3.org/TR/html401/struct/objects.html#h-13.2">image</a>
or a
<a href="http://www.w3.org/TR/html5/the-canvas-element.html">canvas</a>.
When the video is shoot in a uncontrolled environement,
the marker detection may be less reliable, due to variations of lighting.
 <code>threshold</code> is a value between 0 and 255 to adapt your detection to those variations.
To detect the augmented reality markers in the <code>srcElement</code>, just use this line in your
rendering loop.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">threexAR</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>No rocket science here.</p>

<h2>You Use It</h2>

<p>During <code>.update()</code>, the callback is notified with events.
They describe the markers present on the srcElement.
Each event got various fields:
A <code>.markerId</code> which tell you which marker has been recognized.
The
<a href="http://jeromeetienne.github.com/tquery.jsartoolkit/marker">one used above</a>
is the <em>64</em>. You can find the whole list
<a href="https://github.com/kig/JSARToolKit/tree/master/demos/markers">in JSARToolKit repository</a>.</p>

<p>The <code>.type</code> field describe what is happening to this marker.
It may be <em>create</em>, <em>update</em> or <em>delete</em>.
<em>create</em> if the marker has just been detected,
<em>update</em> if the marker was present before.
and <em>delete</em> if the marker is no more present.
Rather obvious :)
The <code>.matrix</code> field is a
<a href="https://github.com/mrdoob/three.js/blob/master/src/core/Matrix4.js">THREE.Matrix4</a>.
It is a transform which matches the position of the marker in space.</p>

<h2>Conclusion</h2>

<p>So now we can do augmented reality in a browser.
The code of the demo is <a href="https://github.com/jeromeetienne/tquery.jsartoolkit">here</a>.
Up to us to find actual application of this technology.
Currently most browsers with webcam are running on desktop/laptop tho.
As most their webcam is directly attached to screens, It limits the flexibility of
what you could put on front of the camera.
As for mobile, only opera 12 is currently the only mobile browser able
to read the webcam.</p>

<p>That&#8217;s all folks. Have fun :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jerome Etienne</span></span>

      








  


<time datetime="2012-03-12T11:36:00+01:00" pubdate data-updated="true">Mar 12<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/augmentedreality/'>augmentedreality</a>, <a class='category' href='/blog/categories/threejs/'>threejs</a>
  
</span>


    </p>
    
      <div class="sharing" style='text-align: right;'>
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/" data-via="LearningThreejs" data-counturl="http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/03/05/tquery-version-0/" title="Previous Post: tQuery v0 - Let's get started">&laquo; tQuery v0 - Let's get started</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/03/20/sounds-for-more-realistic-3d/" title="Next Post: tQuery WebAudio for More Realistic 3D">tQuery WebAudio for More Realistic 3D &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/09/classical-suzanne-monkey-from-blender-to-get-your-game-started-with-threex-dot-suzanne/">Classical Suzanne Monkey From Blender To Get Your Game Started With threex.suzanne</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/07/funky-deformation-for-the-geometry-of-your-three-dot-js-game-with-threex-dot-vertexanimation/">Funky Deformation For The Geometry of Your Three.js Game With threex.vertexanimation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/07/threejs-interview-online-3d-modeling-and-rendering-with-claraio/">Three.js Interview: Online 3D Modeling And Rendering With Clara.io</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/06/scary-monster-for-your-next-fps-game-in-three-dot-js-with-threex-dot-md2character/">Scary Monster For Your Next FPS Game in Three.js With threex.md2character</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/05/simple-and-efficient-3-point-lighting-to-get-your-game-started-with-threex-dot-basiclighting-game-extension-for-three-dot-js/">Simple And Efficient 3 Point Lighting To Get Your Game Started With Threex.basiclighting Game Extension For Three.js</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("LearningThreejs", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/LearningThreejs" class="twitter-follow-button" data-show-count="false">Follow @LearningThreejs</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jerome Etienne -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'learningthreejs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/';
        var disqus_url = 'http://learningthreejs.com/blog/2012/03/12/augmented-reality-in-the-browser/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
